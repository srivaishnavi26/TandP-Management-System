{% extends 'base.html' %}
{% load static %}
{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/staff_dashboard.css' %}">
{% endblock %}
{% block content %}
<div class="dashboard-container">
    <h2>Welcome, {{ staff_profile.name }}</h2>

    <div class="dashboard-cards">
        <div class="dashboard-card">
            <h5>Total Drives</h5>
            <p class="card-number">{{ total_drives }}</p>
        </div>
        <div class="dashboard-card">
            <h5>Upcoming Drives</h5>
            <p class="card-number">{{ upcoming_drives }}</p>
        </div>
    </div>

    <div class="dashboard-actions">
        {% if role == "tpo" or role == "associate_tpo" or role == "head_corporate" %}
            <a href="{% url 'add_drive' %}" class="dashboard-button">Add Drive</a>
            <a href="{% url 'view_students' %}" class="dashboard-button">View Students</a>
            <a href="{% url 'view_drives' %}" class="dashboard-button">View Drives</a>
        {% endif %}

        {% if role == "verbal_trainer" %}
            <a href="{% url 'upload_verbal_material' %}" class="dashboard-button">Upload Verbal Material</a>
        {% endif %}

        {% if role == "aptitude_trainer" %}
            <a href="{% url 'upload_aptitude_test' %}" class="dashboard-button">Upload Aptitude Test</a>
        {% endif %}

        {% if role == "department_coordinator" %}
            <a href="{% url 'department_dashboard' %}" class="dashboard-button">Go to Department Dashboard</a>
        {% endif %}

        {% if role == "technical_trainer" or role == "global_trainer" %}
            <a href="{% url 'upload_technical_material' %}" class="dashboard-button">Upload Technical Content</a>
        {% endif %}

        <a href="{% url 'logout' %}" class="dashboard-button danger-button">Logout</a>
    </div>

    {% if role == "verbal_trainer" and verbal_materials %}
    <h3 style="margin-top: 40px;">Your Uploaded Verbal Materials</h3>
    <table class="materials-table">
        <thead>
            <tr>
                <th>Title</th>
                <th>Uploaded At</th>
                <th>Download</th>
                <th>Delete</th>
            </tr>
        </thead>
        <tbody>
            {% for material in verbal_materials %}
            <tr>
                <td>{{ material.title }}</td>
                <td>{{ material.uploaded_at|date:"Y-m-d H:i" }}</td>
                <td>
                    <a href="{{ material.file.url }}" class="table-button" download>Download</a>
                </td>
                <td>
                    <form method="post" action="{% url 'delete_verbal_material' material.id %}" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" class="table-button danger">Delete</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}

    {% if role == "aptitude_trainer" and aptitude_tests %}
    <h3 style="margin-top: 40px;">Your Uploaded Aptitude Tests</h3>
    <table class="materials-table">
        <thead>
            <tr>
                <th>Title</th>
                <th>Uploaded At</th>
                <th>Download</th>
                <th>Delete</th> </tr>
        </thead>
        <tbody>
            {% for test in aptitude_tests %}
            <tr>
                <td>{{ test.title }}</td>
                <td>{{ test.uploaded_at|date:"Y-m-d H:i" }}</td>
                <td>
                    <a href="{{ test.file.url }}" class="table-button" download>Download</a>
                </td>

                <td>
                    <form method="post" action="{% url 'delete_aptitude_test' test.id %}" style="display:inline;">
                        {% csrf_token %}
                        <button type="submit" class="table-button danger">Delete</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% endif %}
{% if technical_materials %}
        {% if role == "technical_trainer" or role == "global_trainer" %}
            <h3 style="margin-top: 40px;">Your Uploaded Technical Materials</h3>
            <table class="materials-table">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Uploaded At</th>
                        <th>Download</th>
                        <th>Delete</th>
                    </tr>
                </thead>
                <tbody>
                    {% for material in technical_materials %}
                    <tr>
                        <td>{{ material.title }}</td>
                        <td>{{ material.uploaded_at|date:"Y-m-d H:i" }}</td>
                        <td>
                            <a href="{{ material.file.url }}" class="table-button" download>Download</a>
                        </td>
                        <td>
                            <form method="post" action="{% url 'delete_technical_material' material.id %}" style="display:inline;">
                                {% csrf_token %}
                                <button type="submit" class="table-button danger">Delete</button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% endif %}
    {% endif %}
    </div>
{% endblock %}